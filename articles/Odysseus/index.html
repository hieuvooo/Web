<!doctype html>
<html lang="en">

<meta charset="utf-8">
<title>Odysseus &#8211; dayt0n</title>
<meta name="description" content="Should've saved your blobs...">
<meta name="keywords" content="iBEC, iBoot, iBSS, iTunes, idevicerestore, APTicket, SHSH Blobs, downgrade, A5, A6, ios-kexec-utils, kloader">


<meta property="og:locale" content="en_US">
<meta property="og:title" content="Odysseus &#8211; dayt0n">
<meta property="og:description" content="Should've saved your blobs...">
<meta property="og:url" content="/articles/Odysseus">
<meta property="og:site_name" content="dayt0n">


<link href="../../feed.xml" type="application/atom+xml" rel="alternate" title="dayt0n Feed">

<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Crimson+Text:400,400italic,700,700italic" rel='stylesheet' type='text/css' />
<link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="../../assets/css/entypo.css" media="all">

<link rel="stylesheet" href="../../assets/css/i.css">

<script src="../../assets/js/jquery.min.js"></script>

<meta http-equiv="cleartype" content="on">

<script src="../../assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<link rel="shortcut icon" href="../../favicon.ico">

<div id="bump">
  <body class="">
    <header class="site-header">
      <div class="wrap">
        <hgroup>
          <h1><a href="../../index.html">dayt0n</a></h1>
        </hgroup>
        <a href="#nav" class="menu"><span class='icons'>☰</span></a>
        <nav role="navigation">
          <ul>
            <li>
              <a href="../../index.html" title="dayt0n">Home</a>
            </li>
            
            
                <li><a href="../../about/index.html" >about</a></li>
            
                <li><a href="https://github.com/dayt0n" target="_blank">github</a></li>
            
                <li><a href="https://ipsw.me/" target="_blank">ipsw links</a></li>
            
                <li><a href="../../downloads/index.html" >downloads</a></li>
            

          </ul>
        </nav>
      </div>
    </header>


<section class="article">


  <div class="overlay"></div>
  
  <div class="featured-image" style="background-image: url(../../images/APTicket_in_blob.png)"></div>
  



      <article class="wrap post">
        <header class="post-header">
          <hgroup>
            <h1>Odysseus</h1>
            <p class="date">Jun 08, 2015</p>
            <p class="intro">Should've saved your blobs...</p>
          </hgroup>
        </header>

        <h1 id="disclaimer">Disclaimer</h1>
<p>This method currently works on just certain 32bit devices. By certain I mean only for bundles that <a href="http://twitter.com/xerub">xerub</a> can create with keys he has. Also, if your SHSH blobs and APTickets are invalid in any way, this restore will fail and you will be forced to upgrade to the latest signed firmware, which may not currently be jailbreakable. <a href="http://twitter.com/xerub">Xerub</a> or myself are absolutely not responsible for any damage you do to your device or current firmware. There may also be problems with the baseband if you attempt to downgrade to a firmware with a different baseband than you are currently on. Make sure you check the baseband. I cannot stress this enough. If you only know how to click a “jailbreak” button and do not know much about the underlying components of iOS, please do not try this as you will probably mess up your device. I only recommend experienced developer use this tool.</p>

<h1 id="what-is-this">What is this?</h1>
<p>Odysseus is a program written by <a href="http://twitter.com/xerub">xerub</a> that will downgrade your 32bit A5+ devices. This method also works on A4, but why use this on A4 when you have <a href="http://dayt0n.github.io/articles/what-is-limera1n/">limera1n</a>? Anyway, this method uses a tool incuded within <a href="http://twitter.com/winocm">winocm</a>’s ios-kexec-utils. The tool, kloader, is a CLI that you can run on an iOS device that loads an (decrypted) image. It requires a jailbreak currently to run kloader on the device. Odyssseus is fairly simple for the experienced user. It is a tool that allows you to bootstrap a pwned iBSS and then initiate a restore using <a href="https://github.com/xerub/idevicerestore">iDeviceRestore</a> with a custom iPSW that will effectively downgrade/upgrade/restore to any firmware you have valid blobs and an APTicket for. Note: this does not change your baseband, so if you go too far up or down then the core OS will not understand the new software and YMMV.</p>

<h2 id="requirements">Requirements</h2>
<ul>
  <li>
    <p>A jailbroken with the latest untether that has tfp0 enabled. tfp0 enabled untethers include evasi0n, TaiG, and the latest Pangu. For example, early versions of Pangu did not have tfp0 enabled.</p>
  </li>
  <li>
    <p>OpenSSH installed on target device</p>
  </li>
  <li>
    <p>Valid SHSH blobs with valid APTickets. Odysseus comes with a native SHSH blob validator called <code>validate</code>.</p>
  </li>
</ul>

<h2 id="other-options">Other Options</h2>
<p>If for some reason, you would like to go back to the firmware that is currently installed on your device, well, Odysseus has you covered there as well with a method to grab on-device blobs from any 32bit device! After you have completed Step 4: Building the Custom iPSW in the main instructions, continue with these directions:</p>

<h3 id="extract-ibec">Extract iBEC</h3>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">User</span><span class="err">$</span> <span class="n">mv</span> <span class="err">`</span><span class="n">unzip</span> <span class="o">-</span><span class="n">j</span> <span class="n">custom</span><span class="p">.</span><span class="n">ipsw</span> <span class="err">&#39;</span><span class="n">Firmware</span><span class="o">/</span><span class="n">dfu</span><span class="o">/</span><span class="n">iBEC</span><span class="o">*</span><span class="err">&#39;</span> <span class="o">|</span> <span class="n">awk</span> <span class="err">&#39;</span><span class="o">/</span><span class="n">inflating</span><span class="o">/</span><span class="p">{</span><span class="n">print</span> <span class="err">$</span><span class="mi">2</span><span class="p">}</span><span class="err">&#39;`</span> <span class="n">pwnediBEC</span></code></pre></div>

<h3 id="boot-pwned">Boot PWNed</h3>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">User</span><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">sshtool</span> <span class="o">-</span><span class="n">k</span> <span class="p">..</span><span class="o">/</span><span class="n">kloader</span> <span class="o">-</span><span class="n">b</span> <span class="n">pwnediBSS</span> <span class="o">-</span><span class="n">p</span> <span class="mi">22</span> <span class="n">deviceIP</span></code></pre></div>

<p>Wait for the device to enter DFU Mode. Then upload the iBEC you extracted previously:</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">User</span><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">irecovery</span> <span class="o">-</span><span class="n">f</span> <span class="n">pwnediBEC</span></code></pre></div>

<p>Wait for the device to enter what seems like recovery mode (should have a blank, lit screen)</p>

<h3 id="grab-those-blobs">Grab those Blobs!</h3>

<p>Now, you have to execute a few commands with iRecovery:</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">User</span><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">irecovery</span> <span class="o">-</span><span class="n">s</span>
<span class="n">iRecovery</span><span class="o">&gt;</span> <span class="o">/</span><span class="n">send</span> <span class="p">..</span><span class="o">/</span><span class="n">payload</span>
<span class="n">iRecovery</span><span class="o">&gt;</span> <span class="n">go</span> <span class="n">blobs</span>
<span class="n">iRecovery</span><span class="o">&gt;</span> <span class="o">/</span><span class="n">exit</span>
<span class="n">User</span><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">irecovery</span> <span class="o">-</span><span class="n">g</span> <span class="n">myblob</span><span class="p">.</span><span class="n">dump</span>
<span class="n">User</span><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">irecovery</span> <span class="o">-</span><span class="n">s</span>
<span class="n">iRecovery</span><span class="o">&gt;</span> <span class="n">reboot</span></code></pre></div>

<h3 id="unpackvalidate-blobs">Unpack/Validate Blobs</h3>
<p>You must download an iPSW file of the firmware you are currently on now.</p>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">User</span><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">ticket</span> <span class="n">myblob</span><span class="p">.</span><span class="n">dump</span> <span class="n">myblob</span><span class="p">.</span><span class="n">plist</span> <span class="n">matching</span><span class="p">.</span><span class="n">ipsw</span> <span class="o">-</span><span class="n">z</span>
<span class="n">User</span><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">validate</span> <span class="n">myblob</span><span class="p">.</span><span class="n">plist</span> <span class="n">matching</span><span class="p">.</span><span class="n">ipsw</span> <span class="o">-</span><span class="n">z</span></code></pre></div>

<p>If everything checks out and is valid, that means: Yay! It worked! Now you have a fallback to a still jailbreakable version of iOS in case you do not like your downgrade.</p>

<h2 id="instructions">Instructions</h2>

<h3 id="download-the-ipsw-file-you-want-to-downgrade-to-herehttpipswme">1. Download the iPSW file you want to downgrade to <a href="http://ipsw.me/">here</a>.</h3>

<h3 id="validate-the-blobs">2. Validate the Blob(s)</h3>
<ul>
  <li>Convert the .shsh file you have to the xml format and validate:</li>
</ul>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">User</span><span class="err">$</span> <span class="n">zcat</span> <span class="n">myblob</span><span class="p">.</span><span class="n">shsh</span> <span class="o">&gt;</span> <span class="n">myblob</span><span class="p">.</span><span class="n">plist</span>
<span class="n">User</span><span class="err">$</span> <span class="n">plutil</span> <span class="o">-</span><span class="n">convert</span> <span class="n">xml1</span> <span class="n">myblob</span><span class="p">.</span><span class="n">plist</span>
<span class="n">User</span><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">validate</span> <span class="n">myblob</span><span class="p">.</span><span class="n">plist</span> <span class="n">downloaded</span><span class="p">.</span><span class="n">ipsw</span> <span class="o">-</span><span class="n">z</span></code></pre></div>

<ul>
  <li>If you get a bunch of “ERROR”s then, the blob/ticket is not valid, and you should stop now and do not try to downgrade. “WARNING”s are fine.</li>
</ul>

<h3 id="save-your-baseband">3. Save your Baseband</h3>
<ul>
  <li>Enter your SSH password. The default password is <code>alpine</code>:</li>
</ul>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">User</span><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">sshtool</span> <span class="o">-</span><span class="n">s</span> <span class="n">baseband</span><span class="p">.</span><span class="n">tar</span> <span class="o">-</span><span class="n">p</span> <span class="mi">22</span> <span class="n">deviceIP</span></code></pre></div>

<ul>
  <li>If baseband.tar is 0 bytes, that is fine; it probably means your device does not have the baseband on the main filesystem. Any other error, however is bad.</li>
</ul>

<h3 id="build-the-custom-ipsw">4. Build the custom iPSW</h3>
<ul>
  <li>This may take a while.. Use the <code>-memory</code> parameter only if your computer has greater than or equal to four gigabytes of RAM. Also make sure you have the correct bundle in FirmwareBundles/. If the bundle you want is not there, <a href="http://t.co/lXmiOTu6hC">ask for it</a>.</li>
</ul>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">User</span><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">ipsw</span> <span class="n">downloaded</span><span class="p">.</span><span class="n">ipsw</span> <span class="n">custom</span><span class="p">.</span><span class="n">ipsw</span> <span class="o">-</span><span class="n">memory</span> <span class="n">baseband</span><span class="p">.</span><span class="n">tar</span></code></pre></div>

<p>*You can also specify a size for the rootfs if the default size is not big enough. A reason for this would be if you wanted to add large .tar files, and there wasn’t enough room for them. Add however much you need to the original size and round it off a bit. Just use the <code>-s</code> parameter and then the size in megabytes.</p>

<ul>
  <li>Extract the iBSS from the custom iPSW you just built.</li>
</ul>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">User</span><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">xpwntool</span> <span class="err">`</span><span class="n">unzip</span> <span class="o">-</span><span class="n">j</span> <span class="n">custom</span><span class="p">.</span><span class="n">ipsw</span> <span class="err">&#39;</span><span class="n">Firmware</span><span class="o">/</span><span class="n">dfu</span><span class="o">/</span><span class="n">iBSS</span><span class="o">*</span><span class="err">&#39;</span> <span class="o">|</span> <span class="n">awk</span> <span class="err">&#39;</span><span class="o">/</span><span class="n">inflating</span><span class="o">/</span><span class="p">{</span><span class="n">print</span> <span class="err">$</span><span class="mi">2</span><span class="p">}</span><span class="err">&#39;`</span> <span class="n">pwnediBSS</span></code></pre></div>

<h3 id="ssh-into-the-device-and-execute-kloader-as-follows">5. SSH into the device and execute kloader as follows:</h3>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">User</span><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">sshtool</span> <span class="o">-</span><span class="n">k</span> <span class="p">..</span><span class="o">/</span><span class="n">kloader</span> <span class="o">-</span><span class="n">b</span> <span class="n">pwnediBSS</span> <span class="o">-</span><span class="n">p</span> <span class="mi">22</span> <span class="n">deviceIP</span></code></pre></div>

<ul>
  <li>Wait for the device to enter DFU mode. If iTunes doesn’t recognize it within a 2 minutes, unplug and plug back in, but DO NOT press any buttons. Once iTunes recognizes it, kill iTunes. If iTunes doesn’t recognize it after roughly 5 minutes, do a hard reset by holding the home + power button until the Apple Logo appears.</li>
</ul>

<h3 id="make-sure-the-desired-valid-shsh-blob-is-in-shshecid-idevicemodel-versionshsh-then-restore-to-the-custom-ipsw-using-idevicerestore">6. Make sure the desired VALID SHSH blob is in shsh/ECID-iDeviceModel-Version.shsh. Then restore to the custom iPSW using idevicerestore.</h3>

<ul>
  <li>Note: You may need to be root to access USB.</li>
</ul>

<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">User</span><span class="err">$</span> <span class="n">killall</span> <span class="n">iTunesHelper</span>
<span class="n">User</span><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">idevicerestore</span> <span class="o">-</span><span class="n">d</span> <span class="o">-</span><span class="n">w</span> <span class="n">custom</span><span class="p">.</span><span class="n">ipsw</span></code></pre></div>

<h3 id="enjoy-your-downgraded-device-if-you-followed-all-the-instructions-to-a-t-you-will-be-alright-if-not-you-may-be-forced-to-restore-to-the-currently-signed-possibly-non-jailbreakable-firmware">8. Enjoy your downgraded device! If you followed all the instructions to a T, you will be alright, if not, you may be forced to restore to the currently signed, possibly non-jailbreakable firmware.</h3>

<h2 id="download-odysseus-v0999httpdayt0ngithubioodysseusodysseus-0999zip"><a href="http://dayt0n.github.io/odysseus/odysseus-0.999.zip">Download Odysseus v0.999</a></h2>

<p>SHA1 = <code>23717f90a6b5bf847b996648be4c06046bc590b</code></p>

<p>MD5  = <code>ba38fcd9b9eabccd213f2c2d38a813f4</code></p>

<h1 id="credits">Credits</h1>

<ul>
  <li>
    <p><a href="http://twitter.com/xerub">@xerub</a> for this wonderful package</p>
  </li>
  <li>
    <p><a href="http://twitter.com/planetbeing">@planetbeing</a> for xpwn</p>
  </li>
  <li>
    <p><a href="http://twitter.com/winocm">@winocm</a> for ios-kexec-utils</p>
  </li>
  <li>
    <p><a href="http://twitter.com/libimobiledev">@libimobiledev</a> for idevicerestore</p>
  </li>
  <li>
    <p><a href="https://github.com/westbaer">@westbaer</a> for irecovery</p>
  </li>
  <li>
    <p><a href="http://twitter.com/iH8sn0w">@iH8sn0w</a> for some ideas and code</p>
  </li>
  <li>
    <p><a href="http://twitter.com/citrusui">@citrusui</a> for the cool name</p>
  </li>
  <li>
    <p><a href="http://twitter.com/JonathanSeals">@JonathanSeals</a> for some ideas and testing</p>
  </li>
  <li>
    <p><a href="http://twitter.com/daytonhasty">@daytonhasty</a> for exchanging ideas, testing, and writeup</p>
  </li>
</ul>

<center><h3>-dayt0n</h3></center>


      <a class="share" href="https://twitter.com/intent/tweet?text=%22Odysseus%22%20http://dayt0n.com/articles/Odysseus%20via%20@daytonhasty" data-dnt="true">Share</a>
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="../../assets/js/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

      


      </article>

    </section>
</div>

<div class="push"></div>
  <footer>
    <aside class="wrap">
      <ol class="prev-posts">
        <p class="list-title">Recent Posts</p>
            <li>
              <span class="recent-title"><a href="index.html" title="Odysseus">Odysseus </a></span>
              <span class="date">Jun 08, 2015</span>
            </li>
            <li>
              <span class="recent-title"><a href="../dclr-override/index.html" title="DClr_Override">DClr_Override </a></span>
              <span class="date">Feb 10, 2015</span>
            </li>
            <li>
              <span class="recent-title"><a href="../my-new-direction/index.html" title="My New Direction">My New Direction </a></span>
              <span class="date">Feb 01, 2015</span>
            </li>
        
      </ol>

      <div class="social">
        <ul>
            <li><a id="mail" href="../../cdn-cgi/l/email-protection.html#4a2e2b333e7a240a2e2b333e7a2464292527"><span class="foot-link">Contact Me</span></a></li>

            
            <li><a id="twit" href="http://twitter.com/daytonhasty" target="_blank"><span class="foot-link">@daytonhasty</span></a></li>
            
            



            
        </ul>
    </div>
    </aside>
    <center><h5>BTC: 1PUxBGti9U7vXcr64UkvtcLD25axzVh1ER</h5></center>

    <small>&copy; 2017 dayt0n.</small>
  </footer>

  <script>!function(e,t,r,a,n,c,l,o){function h(e,t,r,a){for(r='',a='0x'+e.substr(t,2)|0,t+=2;t<e.length;t+=2)r+=String.fromCharCode('0x'+e.substr(t,2)^a); return r}try{for(n=e.getElementsByTagName('a'),l='/cdn-cgi/l/email-protection#',o=l.length,a=0;a<n.length;a++)try{c=n[a],t=c.href.indexOf(l),t>-1&&(c.href='mailto:'+h(c.href,t+o))}catch(f){}for(n=Array.prototype.slice.apply(e.getElementsByClassName('__cf_email__')),a=0;a<n.length;a++)try{c=n[a],c.parentNode.replaceChild(e.createTextNode(h(c.getAttribute('data-cfemail'),0)),c)}catch(f){}}catch(f){}}(document)</script><script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
  <script src="../../assets/js/retina.min.js"></script>

  <script src="../../assets/js/scripts.js"></script>


  </body>

</html>

